<%
  @slots = []
  views = Dir["#{RAILS_ROOT}/site/views/*.erb"].reject{|f| f.match(/layout.erb/) }.map{|f|
    erb = ERB.new(File.read(f))
    erb.result(binding)
  }
%>

<% form_for @page do |f| %>
  <%= f.label :title %>
  <%= f.text_field :title %>
  <%= f.label :permalink %>
  <%= f.text_field :permalink %>
  <%= f.label :view %>
  <%= f.select :view, ['about', 'article', 'articles', 'home'], {}, {:onchange => "updateSlots()"} %>
  <%= f.submit %>
<% end %>
<script type="text/javascript" src="/javascripts/prototype.js"></script>
<script type="text/javascript">
  var currentPage = <%= ActiveSupport::JSON.encode(@page) %>;
  function updateSlots() {
    console.log("update slots: " + $F("page_view"));
  }
  document.observe("dom:loaded", function() {
    updateSlots();
  });
</script>
